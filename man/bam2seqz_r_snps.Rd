% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bamtoseqz.R
\name{bam2seqz_r_snps}
\alias{bam2seqz_r_snps}
\title{Convert BAM files to seqz format for SNP-based analysis}
\usage{
bam2seqz_r_snps(
  normal_bam,
  tumor_bam,
  genome_fasta = NULL,
  bsgenome = NULL,
  min_depth = 10,
  min_af = 0.25,
  max_af = 0.75,
  gc_window = 50,
  output_file = "output.seqz"
)
}
\arguments{
\item{normal_bam}{Path to the normal (germline) sample BAM file.}

\item{tumor_bam}{Path to the tumor sample BAM file.}

\item{genome_fasta}{Path to the reference genome FASTA file.
Either `genome_fasta` or `bsgenome` must be provided.}

\item{bsgenome}{A BSgenome object (e.g., `BSgenome.Hsapiens.UCSC.hg38`).
Either `genome_fasta` or `bsgenome` must be provided.}

\item{min_depth}{Minimum read depth required for a position to be included.
Default is 10.}

\item{min_af}{Minimum allele frequency for a position to be considered heterozygous.
Default is 0.25.}

\item{max_af}{Maximum allele frequency for a position to be considered heterozygous.
Default is 0.75.}

\item{gc_window}{Size of the window (in bases) for GC-content calculation.
The actual window is `2 * gc_window + 1`. Default is 50 (Â±250 => 501 bp).}

\item{output_file}{Path to the output seqz file. Default is "output.seqz".}
}
\value{
Invisibly returns the path to the output seqz file.
  The function primarily writes output to the specified file.
}
\description{
This function processes paired normal and tumor BAM files to generate
seqz format files suitable for heterozygosity and copy number analysis.
It extracts SNP positions, calculates allele frequencies, and performs
GC-content normalization.
}
\details{
The function performs the following steps:
\enumerate{
  \item Loads reference genome sequence (from FASTA or BSgenome)
  \item Identifies heterozygous SNP positions in the normal sample
  \item Extracts allele counts from tumor sample at SNP positions
  \item Calculates GC-content in windows around each SNP
  \item Performs GC-bias normalization
  \item Outputs results in seqz format
}
}
\note{
\itemize{
  \item BAM files must be sorted and indexed (require .bai files)
  \item For large genomes, parallel processing is recommended
  \item The seqz format is compatible with tools like Sequenza and ASCAT
}
}
\examples{
\dontrun{
# Using BSgenome
library(BSgenome.Hsapiens.UCSC.hg38)
bam2seqz_r_snps(
  normal_bam = "normal.bam",
  tumor_bam = "tumor.bam",
  bsgenome = BSgenome.Hsapiens.UCSC.hg38,
  output_file = "sample.seqz.txt"
)

# Using FASTA file
bam2seqz_r_snps(
  normal_bam = "normal.bam",
  tumor_bam = "tumor.bam",
  genome_fasta = "hg38.fa",
  min_depth = 20,
  output_file = "sample.seqz.txt",
  BPPARAM = BiocParallel::MulticoreParam(workers = 4)
)
}

}
\seealso{
\itemize{
  \item \code{\link[Rsamtools]{scanBam}} for BAM file reading
  \item \code{\link[Biostrings]{readDNAStringSet}} for FASTA reading
  \item \code{\link[sequenza]{sequenza.extract}} for alternative implementation
}
}
